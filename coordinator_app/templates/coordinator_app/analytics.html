{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - ZNHS West</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .sidebar-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-scroll::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
        }

        .sidebar-scroll::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 3px;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Primary colors (red theme)
                        primary: '#991b1b',
                        'primary-dark': '#7f1d1d',
                        secondary: '#eab308',
                        'secondary-dark': '#ca8a04',
                        accent: '#b91c1c',

                        // Coordinator-specific colors
                        coordinator: '#991b1b',
                        'coordinator-dark': '#7f1d1d',
                    },
                    fontFamily: {
                        sans: ['Poppins', 'sans-serif'],
                        display: ['Playfair Display', 'serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-out',
                    }
                },
            },
        }
    </script>
</head>

<body class="bg-gradient-to-br from-gray-50 to-gray-100 min-h-screen font-sans animate-fade-in">
    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside
            class="w-64 bg-gradient-to-b from-primary to-primary-dark text-white flex flex-col fixed h-full z-40 shadow-2xl">
            <div class="p-6 border-b border-red-800">
                <div class="flex items-center gap-3">
                    <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center p-1">
                        <img src="{% static 'assets/westLogo.png' %}" alt="ZNHS West Logo" class="w-full h-full object-contain">
                    </div>
                    <div>
                        <span class="text-xl font-bold block tracking-wide">ZNHS WEST</span>
                        <span class="text-xs text-red-100 opacity-80 font-medium">Coordinator Portal</span>
                    </div>
                </div>
            </div>

            <nav class="flex-1 py-6 sidebar-scroll overflow-y-auto">
                <ul>
                    <li class="mb-2 mx-4">
                        <a href="{% url 'coordinator:dashboard' %}"
                            class="flex items-center gap-4 px-4 py-3 text-white hover:bg-primary/80 rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg">
                            <i class="fas fa-tachometer-alt w-5 text-center text-lg"></i>
                            <span class="font-medium">Dashboard</span>
                        </a>
                    </li>
                    <li class="mb-2 mx-4">
                        <a href="{% url 'coordinator:results_upload' %}"
                            class="flex items-center gap-4 px-4 py-3 text-white hover:bg-primary/80 rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg">
                            <i class="fas fa-upload w-5 text-center text-lg"></i>
                            <span class="font-medium">Upload Results</span>
                        </a>
                    </li>
                    <li class="mb-2 mx-4">
                        <a href="{% url 'coordinator:section_assignment' %}"
                            class="flex items-center gap-4 px-4 py-3 text-white hover:bg-primary/80 rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg">
                            <i class="fas fa-users w-5 text-center text-lg"></i>
                            <span class="font-medium">Section Assignment</span>
                        </a>
                    </li>
                    <li class="mb-2 mx-4">
                        <a href="{% url 'coordinator:analytics' %}"
                            class="flex items-center gap-4 px-4 py-3 text-white bg-primary rounded-xl shadow-lg scale-105 transition-all duration-300">
                            <i class="fas fa-chart-bar w-5 text-center text-lg"></i>
                            <span class="font-semibold">Analytics</span>
                        </a>
                    </li>
                    <li class="mb-2 mx-4">
                        <a href="{% url 'coordinator:reports' %}"
                            class="flex items-center gap-4 px-4 py-3 text-white hover:bg-primary/80 rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg">
                            <i class="fas fa-file-alt w-5 text-center text-lg"></i>
                            <span class="font-medium">Reports</span>
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="p-6 border-t border-red-800">
                <a href="{% url 'admin_app:logout' %}"
                    class="flex items-center gap-4 px-4 py-3 text-white hover:bg-primary/80 rounded-xl transition-all duration-300 hover:scale-[1.02] hover:shadow-lg">
                    <i class="fas fa-sign-out-alt w-5 text-center text-lg"></i>
                    <span class="font-medium">Logout</span>
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-64 p-8">
            <!-- Header -->
            <header class="bg-white rounded-2xl shadow-lg p-6 mb-8 border border-gray-100">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="font-display text-3xl font-bold text-gray-800 mb-2">Analytics Dashboard</h1>
                        <div class="flex items-center gap-4">
                            <div class="flex items-center gap-3 bg-gray-50 px-4 py-2 rounded-xl border border-gray-200">
                                <label for="programFilter" class="text-sm font-semibold text-gray-600">Program:</label>
                                <select id="programFilter"
                                    class="bg-transparent border-none text-sm font-medium text-gray-700 focus:outline-none">
                                    <option value="STEM">STEM</option>
                                    <option value="STE">STE</option>
                                    <option value="SPFL">SPFL</option>
                                </select>
                            </div>
                            <div class="flex items-center gap-3 bg-gray-50 px-4 py-2 rounded-xl border border-gray-200">
                                <label for="timeFilter" class="text-sm font-semibold text-gray-600">Period:</label>
                                <select id="timeFilter"
                                    class="bg-transparent border-none text-sm font-medium text-gray-700 focus:outline-none">
                                    <option value="current">Current SY</option>
                                    <option value="monthly">Last 30 Days</option>
                                    <option value="quarterly">Last Quarter</option>
                                    <option value="yearly">Year Comparison</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center gap-3">
                        <button onclick="exportAnalytics()"
                            class="flex items-center gap-2 text-primary hover:text-primary-dark font-semibold">
                            <i class="fas fa-download"></i>
                            Export Data
                        </button>
                        <div class="flex items-center gap-3 bg-gray-50 px-4 py-2 rounded-xl border border-gray-200">
                            <div class="text-right hidden sm:block">
                                <span class="block font-semibold text-gray-800">Garcia, Juan P.</span>
                                <span
                                    class="block text-xs text-gray-500 bg-primary/10 text-primary px-2 py-1 rounded-full font-medium">STEM
                                    Coordinator</span>
                            </div>
                            <div class="w-12 h-12 rounded-xl overflow-hidden border-2 border-white shadow-lg">
                                <img src="../../shared_assets/static/images/patrick.jpeg" alt="Coordinator"
                                    class="w-full h-full object-cover">
                            </div>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Key Metrics -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-white rounded-2xl p-6 border border-gray-200 shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">Qualification Rate</p>
                            <p class="text-2xl font-bold text-gray-800">60.5%</p>
                            <p class="text-green-600 text-sm flex items-center gap-1">
                                <i class="fas fa-arrow-up"></i>
                                <span>+2.3% from last year</span>
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center">
                            <i class="fas fa-percentage text-green-600 text-xl"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-2xl p-6 border border-gray-200 shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">Average Exam Score</p>
                            <p class="text-2xl font-bold text-gray-800">84.7</p>
                            <p class="text-green-600 text-sm flex items-center gap-1">
                                <i class="fas fa-arrow-up"></i>
                                <span>+1.5 points</span>
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center">
                            <i class="fas fa-chart-line text-primary text-xl"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-2xl p-6 border border-gray-200 shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">AI Assignment Accuracy</p>
                            <p class="text-2xl font-bold text-gray-800">85%</p>
                            <p class="text-green-600 text-sm flex items-center gap-1">
                                <i class="fas fa-arrow-up"></i>
                                <span>+5% improvement</span>
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center">
                            <i class="fas fa-robot text-purple-600 text-xl"></i>
                        </div>
                    </div>
                </div>
                <div class="bg-white rounded-2xl p-6 border border-gray-200 shadow-lg">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-gray-500 text-sm">Processing Time</p>
                            <p class="text-2xl font-bold text-gray-800">2.4h</p>
                            <p class="text-red-600 text-sm flex items-center gap-1">
                                <i class="fas fa-arrow-down"></i>
                                <span>-0.8h faster</span>
                            </p>
                        </div>
                        <div class="w-12 h-12 bg-yellow-100 rounded-xl flex items-center justify-center">
                            <i class="fas fa-clock text-yellow-600 text-xl"></i>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Charts Grid -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <!-- Score Distribution -->
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">Exam Score Distribution</h2>
                        <select
                            class="text-sm border border-gray-300 rounded-lg px-3 py-1 focus:outline-none focus:ring-2 focus:ring-primary">
                            <option>STEM</option>
                            <option>STE</option>
                            <option>SPFL</option>
                        </select>
                    </div>
                    <div class="h-64">
                        <canvas id="scoreDistributionChart"></canvas>
                    </div>
                </div>

                <!-- Qualification Trends -->
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">Qualification Trends</h2>
                        <select
                            class="text-sm border border-gray-300 rounded-lg px-3 py-1 focus:outline-none focus:ring-2 focus:ring-primary">
                            <option>2025-2026</option>
                            <option>2024-2025</option>
                            <option>2023-2024</option>
                        </select>
                    </div>
                    <div class="h-64">
                        <canvas id="qualificationTrendChart"></canvas>
                    </div>
                </div>

                <!-- Section Balance -->
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">Section Balance Analysis</h2>
                        <button onclick="refreshSectionBalance()" class="text-primary hover:text-primary-dark">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                    <div class="h-64">
                        <canvas id="sectionBalanceChart"></canvas>
                    </div>
                </div>

                <!-- AI Performance -->
                <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold text-gray-800">AI Assignment Performance</h2>
                        <div class="flex items-center gap-2">
                            <span class="text-sm text-gray-600">Confidence:</span>
                            <span
                                class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">85%</span>
                        </div>
                    </div>
                    <div class="h-64">
                        <canvas id="aiPerformanceChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Detailed Analytics -->
            <div class="bg-white rounded-2xl shadow-lg p-6 border border-gray-200">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">Detailed Analytics</h2>
                    <div class="flex gap-3">
                        <button onclick="printAnalytics()"
                            class="flex items-center gap-2 text-gray-600 hover:text-gray-700 font-semibold">
                            <i class="fas fa-print"></i>
                            Print
                        </button>
                        <button onclick="generateReport()"
                            class="flex items-center gap-2 text-primary hover:text-primary-dark font-semibold">
                            <i class="fas fa-file-pdf"></i>
                            Generate Report
                        </button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-gray-50 p-4 rounded-xl">
                        <h3 class="font-semibold text-gray-700 mb-3">Gender Distribution</h3>
                        <div class="space-y-2">
                            <div class="flex justify-between">
                                <span class="text-gray-600">Male</span>
                                <span class="font-semibold">45%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-primary h-2 rounded-full w-[45%]"></div>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600">Female</span>
                                <span class="font-semibold">55%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-pink-600 h-2 rounded-full w-[55%]"></div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-xl">
                        <h3 class="font-semibold text-gray-700 mb-3">Top Performing Schools</h3>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>ZNHS Central</span>
                                    <span class="font-semibold">92%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-green-600 h-2 rounded-full w-[92%]"></div>
                                </div>
                            </div>
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>Zamboanga City High</span>
                                    <span class="font-semibold">87%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="bg-primary h-2 rounded-full w-[87%]"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gray-50 p-4 rounded-xl">
                        <h3 class="font-semibold text-gray-700 mb-3">Processing Efficiency</h3>
                        <div class="text-center">
                            <div class="text-3xl font-bold text-green-600 mb-2">78%</div>
                            <p class="text-sm text-gray-600">Tasks Automated</p>
                            <div class="mt-3 text-sm">
                                <div class="flex justify-between mb-1">
                                    <span>Manual Processing</span>
                                    <span>22%</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>AI Processing</span>
                                    <span>78%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Data Table -->
                <div class="overflow-x-auto rounded-xl border border-gray-200">
                    <table class="w-full">
                        <thead class="bg-gradient-to-r from-primary to-primary-dark">
                            <tr>
                                <th class="px-6 py-4 text-left font-semibold text-white">Metric</th>
                                <th class="px-6 py-4 text-left font-semibold text-white">Current SY</th>
                                <th class="px-6 py-4 text-left font-semibold text-white">Previous SY</th>
                                <th class="px-6 py-4 text-left font-semibold text-white">Change</th>
                                <th class="px-6 py-4 text-left font-semibold text-white">Trend</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 font-medium text-gray-900">Total Applicants</td>
                                <td class="px-6 py-4 text-gray-600">248</td>
                                <td class="px-6 py-4 text-gray-600">215</td>
                                <td class="px-6 py-4">
                                    <span
                                        class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">+15.3%</span>
                                </td>
                                <td class="px-6 py-4">
                                    <i class="fas fa-arrow-up text-green-600"></i>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 font-medium text-gray-900">Qualification Rate</td>
                                <td class="px-6 py-4 text-gray-600">60.5%</td>
                                <td class="px-6 py-4 text-gray-600">58.2%</td>
                                <td class="px-6 py-4">
                                    <span
                                        class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">+2.3%</span>
                                </td>
                                <td class="px-6 py-4">
                                    <i class="fas fa-arrow-up text-green-600"></i>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 font-medium text-gray-900">Avg Exam Score</td>
                                <td class="px-6 py-4 text-gray-600">84.7</td>
                                <td class="px-6 py-4 text-gray-600">83.2</td>
                                <td class="px-6 py-4">
                                    <span
                                        class="px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-semibold">+1.5</span>
                                </td>
                                <td class="px-6 py-4">
                                    <i class="fas fa-arrow-up text-green-600"></i>
                                </td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 font-medium text-gray-900">Processing Time</td>
                                <td class="px-6 py-4 text-gray-600">2.4 hours</td>
                                <td class="px-6 py-4 text-gray-600">3.2 hours</td>
                                <td class="px-6 py-4">
                                    <span
                                        class="px-2 py-1 bg-red-100 text-red-800 rounded-full text-xs font-semibold">-0.8h</span>
                                </td>
                                <td class="px-6 py-4">
                                    <i class="fas fa-arrow-down text-red-600"></i>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script src="../js/analytics.js"></script>
</body>

</html>